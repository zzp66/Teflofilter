{{- 'facets.css' | asset_url | stylesheet_tag -}}
{%- liquid
  assign enable_filtering = section.settings.enable_filtering
  assign enable_sorting = section.settings.enable_sorting
  assign show_counts = section.settings.show_counts
  assign filter_color_swatches = section.settings.filter_color_swatches
  assign filters_collapsed = section.settings.filters_collapsed
  assign pagination_type = section.settings.pagination_type
  assign products_per_page = section.settings.products_per_page
  assign columns_desktop = section.settings.columns_desktop
  assign facets_desktop = section.settings.facets_desktop

  unless enable_filtering
    assign facets_desktop = 'drawer'
  endunless
-%}
{%- for filter in collection.filters limit: 1 -%}
{%- endfor -%}
{%- comment -%} This is just to get rid of the "this theme does not support filters" message in the shopify admin {%- endcomment -%}
{%- render 'facets-mobile',
  results: collection,
  enable_filtering: enable_filtering,
  enable_sorting: enable_sorting,
  show_counts: show_counts,
  filter_color_swatches: filter_color_swatches,
  filters_collapsed: filters_collapsed
-%}

<style>
  .product-grid-v1-content {
    padding: 0 calc(100vw * 20 / var(--base-width));
    background-color: #fff;
  }
  .product-grid-v1-content h2.product-grid-v1-title {
    font-size: calc(100vw * 60 / var(--base-width));
    line-height: calc(100vw * 66 / var(--base-width));
    color: #191919;
    margin-bottom: calc(100vw * 40 / var(--base-width));
  }
  .product-grid-v1-content .section-spacing-bottom {
    margin: 0;
  }
  .product-grid-v1-content .sidebar-container.facets--sidebar {
    justify-content: space-between;
  }
  .product-grid-v1-content .sidebar-container {
    display: flex;
    gap: inherit;
  }
  .product-grid-v1-content .facets-desktop-container {
    max-width: none;
    width: calc(100vw * 314 / var(--base-width));
  }
  .product-grid-box {
    width: calc(100vw * 1045 / var(--base-width));
  }
  ul#product-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    column-gap: calc(100vw * 20 / var(--base-width));
    row-gap: calc(100vw * 60 / var(--base-width));
  }
  .teflo-our-product-list-item-img {
    width: 100%;
    height: calc(100vw * 430 / var(--base-width));
    border-radius: calc(100vw * 3 / var(--base-width));
    background: #edf1f3;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    margin-bottom: calc(100vw * 20 / var(--base-width));
  }
  .teflo-our-product-list-item-info {
    display: flex;
    justify-content: center;
    align-items: center;
    padding-bottom: calc(100vw * 14 / var(--base-width));
    border-bottom: 1px solid rgba(25, 25, 25, 0.3);
    position: relative;
  }
  .teflo-our-product-list-item-info::before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 1px;
    background: #0522cb;
    transition: width 0.3s ease;
    z-index: 2;
  }
  .teflo-our-product-list-item:hover .teflo-our-product-list-item-info::before {
    width: 100%;
  }
  .teflo-our-product-list-item-info-lt {
    display: flex;
    flex: 1;
  }
  .teflo-our-product-list-item-rt {
    flex-shrink: 0;
  }
  .teflo-our-product-list-item-info-lt-h3 {
    color: #191919;
    font-size: calc(100vw * 20 / var(--base-width));
    font-style: normal;
    font-weight: 500;
    line-height: calc(100vw * 26 / var(--base-width));
    margin-bottom: 0px;
  }
  .teflo-our-product-list-item-info-lt-btn {
    display: inline-block;
    color: #191919;
    font-size: calc(100vw * 12 / var(--base-width));
    font-style: normal;
    font-weight: 400;
    line-height: calc(100vw * 14 / var(--base-width));
    padding: calc(100vw * 3 / var(--base-width)) calc(100vw * 8 / var(--base-width));
    margin-left: calc(100vw * 18 / var(--base-width));
    border-radius: calc(100vw * 3 / var(--base-width));
    border: 0.3px solid #191919;
    height: fit-content;
    cursor: pointer;
    width: fit-content;
  }
  .teflo-our-product-list-item-info-lt-btn:hover {
    background: #0522cb;
    color: #fff;
    border: 0.3px solid transparent;
  }
  .teflo-our-product-list-item-rt svg {
    width: calc(100vw * 12 / var(--base-width));
    height: calc(100vw * 10 / var(--base-width));
  }
  @media (max-width: 1300px) {
    .teflo-our-product-list {
      grid-template-columns: repeat(3, 1fr);
    }
    .teflo-our-product-desc strong {
      font-size: calc(100vw * 20 / var(--base-width));
    }
  }
  @media screen and (max-width: 1067px) {
    .product-grid-v1-content .facets--bar-sticky {
      background-color: #fff;
    }
    .product-grid-box {
      max-width: none;
    }
  }
  @media (max-width: 1024px) {
    .teflo-our-product {
      padding: 0 calc(100vw * 25 / var(--base-width));
      padding-top: calc(100vw * 170 / var(--base-width));
    }
    .teflo-our-product-h2 {
      font-size: calc(100vw * 70 / var(--base-width));
      line-height: calc(100vw * 76 / var(--base-width));
      letter-spacing: calc(100vw * -2.1 / var(--base-width));
      margin-bottom: calc(100vw * 30 / var(--base-width));
    }
    .teflo-our-product-desc {
      margin-bottom: calc(100vw * 70 / var(--base-width));
      max-width: 100%;
    }
    .teflo-our-product-desc * {
      font-size: calc(100vw * 30 / var(--base-width));
      line-height: calc(100vw * 36 / var(--base-width));
    }
    .teflo-our-product-desc p {
      line-height: calc(100vw * 36 / var(--base-width));
    }
    .teflo-our-product-desc strong {
      font-size: calc(100vw * 27 / var(--base-width));
    }
    .teflo-our-product-list-item-info {
      padding-bottom: calc(100vw * 20 / var(--base-width));
      align-items: end;
      position: relative;
    }

    .teflo-our-product-list {
      grid-template-columns: repeat(2, 1fr);
      column-gap: calc(100vw * 20 / var(--base-width));
      row-gap: calc(100vw * 60 / var(--base-width));
    }
    .teflo-our-product-list-item-img {
      height: calc(100vw * 437 / var(--base-width));
    }
    .teflo-our-product-list-item-info-lt {
      display: flex;
      flex-direction: column-reverse;
    }
    .teflo-our-product-list-item-info-lt a {
      display: flex;
      align-items: center;
    }
    .teflo-our-product-list-item-info-lt-btn {
      margin-left: 0;
      margin-bottom: calc(100vw * 15 / var(--base-width));
      padding: calc(100vw * 8 / var(--base-width)) calc(100vw * 11 / var(--base-width));
      font-size: calc(100vw * 14 / var(--base-width));
    }
    .teflo-our-product-list-item-info-lt-h3 {
      font-size: calc(100vw * 26 / var(--base-width));
      line-height: calc(100vw * 32 / var(--base-width));
      margin-bottom: 0;
    }
    .teflo-our-product-list-item-rt {
      display: flex;
      align-items: end;
    }
    .teflo-our-product-list-item-rt svg {
      width: calc(100vw * 19 / var(--base-width));
      height: calc(100vw * 17 / var(--base-width));
    }
  }
  @media (max-width: 750px) {
    .product-grid-v1-content h2.product-grid-v1-title {
      text-align: center;
      font-size: calc(100vw * 70 / var(--base-width));
      line-height: calc(100vw * 70 / var(--base-width));
      margin-bottom: calc(100vw * 30 / var(--base-width));
    }
    .product-grid-box .facets--bar .thb-filter-sort-count {
      text-align: center;
      width: 100%;
      justify-content: center;
    }
    ul#product-grid {
      grid-template-columns: repeat(2, 1fr);
      column-gap: calc(100vw * 20 / var(--base-width));
      row-gap: calc(100vw * 60 / var(--base-width));
    }
  }
</style>
<div class="product-grid-v1">
  <div class="product-grid-v1-content">
    <h2 class="product-grid-v1-title">Product classification</h2>
    {%- paginate collection.products by products_per_page -%}
      <div class="collection-container section-spacing-bottom">
        <div id="ProductGridContainer">
          <div class="sidebar-container facets--{{ facets_desktop }} results--{{ collection.products.size }}">
            {%- if facets_desktop == 'sidebar' -%}
              {%- render 'facets-desktop',
                results: collection,
                enable_filtering: enable_filtering,
                enable_sorting: enable_sorting,
                show_counts: show_counts,
                filter_color_swatches: filter_color_swatches,
                filters_collapsed: filters_collapsed
              -%}
            {%- endif -%}
            <div class="product-grid-box">
              {%- render 'facets-bar',
                results: collection,
                enable_filtering: enable_filtering,
                enable_sorting: enable_sorting,
                facets_desktop: facets_desktop,
                filter_color_swatches: filter_color_swatches
              -%}
              <ul
                id="product-grid"
                data-id="{{ section.id }}"
                class="product-grid-ul"
              >
                {%- if collection.products.size == 0 -%}
                  <div class="collection-empty">
                    {% render 'svg-icons' with 'thb-no-products' %}
                    <p>
                      {{ 'sections.collection_template.empty' | t -}}
                      <br>
                      {%- if collection.terms -%}
                        {{ 'sections.collection_template.use_fewer_filters_html' | t: link: collection.url }}
                      {%- endif -%}
                    </p>
                  </div>
                {%- else -%}
                  {%- for product in collection.products -%}
                    {%- assign product_loop = forloop -%}
                    {%- for block in section.blocks -%}
                      {%- liquid
                        assign display_promotion = false
                        if product_loop.index == block.settings.promotion_position
                          assign display_promotion = true
                        endif

                        if block.settings.promotion_collection != blank
                          if collection.handle == block.settings.promotion_collection.handle and product_loop.index == block.settings.promotion_position
                            assign display_promotion = true
                          else
                            assign display_promotion = false
                          endif
                        endif
                      -%}
                      {%- if display_promotion -%}
                        {{- 'gallery.css' | asset_url | stylesheet_tag -}}
                        <li class="promotion-column column promotion-column-width--{{ block.settings.promotion_width }} product-columns-{{ columns_desktop }}">
                          {%- render 'product-promotion', block: block -%}
                        </li>
                      {%- endif -%}
                    {%- endfor -%}
                    <li class="grid-item">
                      {%- render 'product-card-v1', product: product -%}
                    </li>
                  {%- endfor -%}
                {%- endif -%}
                <li class="loading-overlay">
                  <div class="loading-overlay--sticky">
                    {% render 'svg-icons' with 'thb-loading' %}
                  </div>
                </li>
              </ul>
              {% render 'pagination', paginate: paginate, pagination_type: pagination_type, id: section.id %}
            </div>
          </div>
        </div>
      </div>
    {%- endpaginate -%}
  </div>
</div>

{%- if enable_filtering or enable_sorting -%}
  {%- if enable_filtering -%}
    {{ 'nouislider.js' | asset_url | script_tag }}
  {%- endif -%}
  <script src="{{ 'facets.js' | asset_url }}" defer="defer"></script>
{%- endif -%}
{% render 'compare-drawer' %}
{% schema %}
{
  "name": "Product Grid V1",
  "class": "product-grid-v1",
  "settings": [
    {
      "type": "range",
      "id": "products_per_page",
      "min": 2,
      "max": 48,
      "step": 1,
      "label": "Number of products",
      "default": 12
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 2,
      "max": 5,
      "step": 1,
      "label": "Number of columns on desktop",
      "default": 3
    },
    {
      "type": "select",
      "id": "pagination_type",
      "options": [
        {
          "value": "paginated",
          "label": "Paginated"
        },
        {
          "value": "loadmore",
          "label": "Click to load"
        },
        {
          "value": "infinite",
          "label": "Infinite"
        }
      ],
      "default": "paginated",
      "label": "Pagination",
      "info": "Choose how additional pages of products are navigated."
    },
    {
      "type": "header",
      "content": "Filtering and sorting"
    },
    {
      "type": "checkbox",
      "id": "enable_filtering",
      "default": true,
      "label": "Enable filtering",
      "info": "Customize [filters](/admin/menus)"
    },
    {
      "type": "checkbox",
      "id": "enable_sorting",
      "default": true,
      "label": "Enable sorting"
    },
    {
      "type": "checkbox",
      "id": "show_counts",
      "default": true,
      "label": "Show filter values count"
    },
    {
      "type": "checkbox",
      "id": "filter_color_swatches",
      "default": true,
      "label": "Show color swatches"
    },
    {
      "type": "checkbox",
      "id": "filters_collapsed",
      "default": false,
      "label": "Collapse filters by default"
    },
    {
      "type": "select",
      "id": "facets_desktop",
      "options": [
        {
          "value": "sidebar",
          "label": "Sidebar"
        },
        {
          "value": "drawer",
          "label": "Drawer"
        }
      ],
      "default": "sidebar",
      "label": "Desktop position",
      "info": "Position of filters on desktop"
    }
  ],
  "blocks": [
    {
      "type": "promotion",
      "name": "Promotion",
      "settings": [
        {
          "type": "collection",
          "id": "promotion_collection",
          "label": "Collection",
          "info": "Show on specific collection only"
        },
        {
          "type": "range",
          "id": "promotion_position",
          "min": 1,
          "max": 24,
          "step": 1,
          "label": "Show in position",
          "default": 1
        },
        {
          "type": "select",
          "id": "promotion_width",
          "options": [
            {
              "value": "1",
              "label": "1 column"
            },
            {
              "value": "2",
              "label": "2 columns"
            }
          ],
          "default": "1",
          "label": "Width"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "title",
          "default": "Promotion",
          "label": "Heading"
        },
        {
          "type": "textarea",
          "id": "text",
          "default": "Advertise a promotion or a sale",
          "label": "Description"
        },
        {
          "id": "link_label",
          "type": "text",
          "label": "Button label",
          "default": "Explore",
          "info": "Leave the label blank to hide the button."
        },
        {
          "type": "select",
          "id": "content_position",
          "label": "Content position",
          "options": [
            { "value": "top-left", "label": "Top left" },
            { "value": "top-center", "label": "Top center" },
            { "value": "top-right", "label": "Top right" },
            { "value": "middle-left", "label": "Middle left" },
            { "value": "middle-center", "label": "Middle center" },
            { "value": "middle-right", "label": "Middle right" },
            { "value": "bottom-left", "label": "Bottom left" },
            { "value": "bottom-center", "label": "Bottom center" },
            { "value": "bottom-right", "label": "Bottom right" }
          ],
          "default": "bottom-left"
        },
        {
          "type": "select",
          "id": "text_alignment",
          "options": [
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "center",
              "label": "Center"
            },
            {
              "value": "right",
              "label": "Right"
            }
          ],
          "default": "left",
          "label": "Content alignment"
        },
        {
          "id": "link",
          "type": "url",
          "label": "Button link"
        },
        {
          "type": "checkbox",
          "id": "use_text_button",
          "label": "Use text button",
          "default": false
        },
        {
          "id": "block_link",
          "type": "url",
          "label": "Link",
          "info": "This will allow you to set a link to the promotion"
        },
        {
          "type": "header",
          "content": "Colors"
        },
        {
          "type": "color",
          "id": "overlay_color",
          "label": "Overlay",
          "default": "#000000"
        },
        {
          "type": "range",
          "id": "overlay_opacity",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Overlay opacity",
          "default": 70
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product Grid V1"
    }
  ]
}
{% endschema %}
